---
layout: post
title: 第70回駒場祭準備の様子
author: 日塔
image: https://drive.google.com/thumbnail?id=1qJo4XZrEFK7nwWuBpc4rUTTsFRp1On55&sz=w1200-h900
---

2019年11月に行われた駒場祭にプラレーラーズは参加しました。ここではその準備の様子をご紹介したいと思います。

今回の駒場祭に向けての開発は主に以下の4つのものでした。

- 赤外線による無線運転
- レール上のマーカの読み取り
- 運行システムの構築
- 新丹那トンネルの作成

それぞれ順番にご紹介します。

### 赤外線による無線運転

駒場祭の準備は五月祭が終わったあとすぐに始まりました。五月祭ではポイントレールとストップレールを操作してプラレールがぶつからないような工夫を行いましたが、駒場祭では当初から無線で車両自体を動かしたいという考えがありました。

無線の種類として赤外線、Bluetooth、Wi-Fiが候補にありましたが、最も基本的な通信方法として扱いやすいであろうとして赤外線通信を選択しました。

{% include youtube id="mbjsjeg4518" %}

### レール上のマーカの読み取り

この赤外線通信の開発と並行して、車両による在線検知システムの開発を行いました。五月祭ではレール側にセンサを埋め込んで車両の在線検知を行っていましたが、ジオラマ上の配線が複雑になるという課題を抱えていました。そこで、センサを車両側に積むことになりました。

駅の車両が止まる場所には黒いテープと銀色のテープを貼りました。そのマーカーの上を車両が通ると感知する様になっています。

車両の裏には赤色LEDと光が当たると抵抗値が小さくなる特性を持つCdSセンサが付けました。赤色LEDの光はレールに反射してCdSセンサに読み取られます。黒いテープから銀色のテープに移る時に読み取り値の変化が最も大きくなるためそこをマーカーとして認識させます。読み取り値は移動平均を用いて滑らかにしているので、高周波数のノイズの影響を受けにくくなっています。

![マーカの読み取り方](https://drive.google.com/thumbnail?id=1SDRvFDOLI3vReYRVg9RNVhPWwURiEmJv&sz=w1200-h900)

### 運行システムの構築

車両が受け取った位置情報と時刻表を入力としてダイヤに従った運行を実行するシステムの開発もしました。当初の計画では6つの車両と6つの駅を設置するものを考えていました。ダイヤグラムを考えて、それを元にどのタイミングでポイントを切り替える指令を出すかなどのアルゴリズムを考えました。

これらは駒場祭本番で披露することが叶いませんでしたが、五月祭に向けてさらに拡充する予定です。

### 新丹那トンネルの製作

今回の駒場祭は東海道新幹線を舞台としていたので、ジオラマは新丹那トンネルを作成しました。作成途中で何度か事故がありましたが、部員の友達の助けもあり、かなり迫力のあるものができたと自負しております。

![作成途中の新丹那トンネル](https://drive.google.com/thumbnail?id=1qJo4XZrEFK7nwWuBpc4rUTTsFRp1On55&sz=w1200-h900)
